{"version":3,"file":"jsNodes_data_subscribe_v0_2_0_subscribe_ts.js","sources":["./jsNodes/data/subscribe/v0.2.0/subscribe.ts"],"sourcesContent":["import useData from '../../../../libs/useData/v0.2.0/useData'\nimport { dbClassVersion, dbVersion } from '../../../../utils/data/v0.2.0/data'\n\nexport default function node() {\n    const { dbClasses, debug } = window.Rolder\n\n    if (dbClasses) {\n        let subscribedDbClasses: string[] = []\n        Object.keys(dbClasses).forEach(dbClass => {\n            if (dbClasses[dbClass].subscribe) {\n                const index = dbVersion()\n                const dbClassV = dbClassVersion(dbClass)\n\n                window.Kuzzle.realtime.subscribe(index, dbClassV, {},\n                    (notif: { type: string; result: any }) => {\n                        if (notif.type !== 'document') return\n                        if (debug > 1) console.log('new ' + dbClassV + ' recieved:', notif.result)\n                        useData.invalidate({ dbClass })\n                    }\n                )\n                subscribedDbClasses.push(dbClassV)\n            }\n        })\n        if (debug > 1) console.log('Subscribed to: ', subscribedDbClasses)\n    }\n}"],"names":["node","dbClasses","debug","window","Rolder","subscribedDbClasses","Object","keys","forEach","dbClass","subscribe","index","dbVersion","dbClassV","dbClassVersion","Kuzzle","realtime","notif","type","console","log","result","invalidate","push"],"mappings":"iOAGA,W,oCAAwBA,C,0CAAT,SAASA,IACpB,GAAM,CAAEC,UAAAA,CAAS,CAAEC,MAAAA,CAAK,CAAE,CAAGC,OAAOC,OAEpC,GAAIH,EAAW,CACX,IAAII,EAAgC,EAAE,CACtCC,OAAOC,KAAKN,GAAWO,QAAQ,AAAAC,IAC3B,GAAIR,CAAS,CAACQ,EAAQ,CAACC,UAAW,CAC9B,IAAMC,EAAQ,KAAAC,SAAA,IACRC,EAAW,KAAAC,cAAA,EAAeL,GAEhCN,OAAOY,OAAOC,SAASN,UAAUC,EAAOE,EAAU,CAAC,EAC/C,AAACI,IACsB,aAAfA,EAAMC,OACNhB,EAAQ,GAAGiB,QAAQC,IAAI,OAASP,EAAW,aAAcI,EAAMI,QACnE,UAAQC,WAAW,CAAEb,QAAAA,CAAQ,GACjC,GAEJJ,EAAoBkB,KAAKV,EAC7B,CACJ,GACIX,EAAQ,GAAGiB,QAAQC,IAAI,kBAAmBf,EAClD,CACJ,C"}