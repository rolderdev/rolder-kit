{"version":3,"file":"nodes_data_subscribe_subscribe_v0_1_0_js.js","sources":["./nodes/data/subscribe/subscribe_v0.1.0.js"],"sourcesContent":["import useData from '../../../libs/use-data/v0.1.0/use-data'\nimport { classVersion, dbVersion } from '../../../utils/data/v.0.1.0/data'\n\nexport default function node() {\n    const { classes, debug } = Rolder\n\n    if (classes) {\n        let subscribedClasses = []\n        Object.keys(classes).forEach(className => {\n            if (classes[className].subscribe) {\n                const index = dbVersion()\n                const classNameV = classVersion(className)\n\n                Kuzzle.realtime.subscribe(index, classNameV, {},\n                    notif => {\n                        if (notif.type !== 'document') return\n                        if (debug > 1) console.log('new ' + classNameV + ' recieved:', notif.result)\n                        useData.invalidate({ className })\n                    }\n                )\n                subscribedClasses.push(classNameV)\n            }\n        })\n        if (debug > 1) console.log('Subscribed to: ', subscribedClasses)\n    }\n}"],"names":["node","classes","debug","Rolder","subscribedClasses","Object","keys","forEach","className","subscribe","index","dbVersion","classNameV","classVersion","Kuzzle","realtime","notif","type","console","log","result","invalidate","push"],"mappings":"+NAGA,W,oCAAwBA,C,yCAAT,SAASA,IACpB,GAAM,CAAEC,QAAAA,CAAO,CAAEC,MAAAA,CAAK,CAAE,CAAGC,OAE3B,GAAIF,EAAS,CACT,IAAIG,EAAoB,EAAE,CAC1BC,OAAOC,KAAKL,GAASM,QAAQ,AAAAC,IACzB,GAAIP,CAAO,CAACO,EAAU,CAACC,UAAW,CAC9B,IAAMC,EAAQ,KAAAC,SAAA,IACRC,EAAa,KAAAC,YAAA,EAAaL,GAEhCM,OAAOC,SAASN,UAAUC,EAAOE,EAAY,CAAC,EAC1C,AAAAI,IACuB,aAAfA,EAAMC,OACNf,EAAQ,GAAGgB,QAAQC,IAAI,OAASP,EAAa,aAAcI,EAAMI,QACrE,UAAQC,WAAW,CAAEb,UAAAA,CAAU,GACnC,GAEJJ,EAAkBkB,KAAKV,EAC3B,CACJ,GACIV,EAAQ,GAAGgB,QAAQC,IAAI,kBAAmBf,EAClD,CACJ,C"}