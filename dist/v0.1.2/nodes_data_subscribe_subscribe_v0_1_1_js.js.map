{"version":3,"file":"nodes_data_subscribe_subscribe_v0_1_1_js.js","sources":["./nodes/data/subscribe/subscribe_v0.1.1.js"],"sourcesContent":["import useData from '../../../libs/useData/v0.1.1/useData'\nimport { dbClassVersion, dbVersion } from '../../../utils/data/v.0.1.1/data'\n\nexport default function node() {\n    const { dbClasses, debug } = Rolder\n\n    if (dbClasses) {\n        let subscribedDbClasses = []\n        Object.keys(dbClasses).forEach(dbClass => {\n            if (dbClasses[dbClass].subscribe) {\n                const index = dbVersion()\n                const dbClassV = dbClassVersion(dbClass)\n\n                Kuzzle.realtime.subscribe(index, dbClassV, {},\n                    notif => {\n                        if (notif.type !== 'document') return\n                        if (debug > 1) console.log('new ' + dbClassV + ' recieved:', notif.result)\n                        useData.invalidate({ dbClass })\n                    }\n                )\n                subscribedDbClasses.push(dbClassV)\n            }\n        })\n        if (debug > 1) console.log('Subscribed to: ', subscribedDbClasses)\n    }\n}"],"names":["node","dbClasses","debug","Rolder","subscribedDbClasses","Object","keys","forEach","dbClass","subscribe","index","dbVersion","dbClassV","dbClassVersion","Kuzzle","realtime","notif","type","console","log","result","invalidate","push"],"mappings":"+NAGA,W,oCAAwBA,C,yCAAT,SAASA,IACpB,GAAM,CAAEC,UAAAA,CAAS,CAAEC,MAAAA,CAAK,CAAE,CAAGC,OAE7B,GAAIF,EAAW,CACX,IAAIG,EAAsB,EAAE,CAC5BC,OAAOC,KAAKL,GAAWM,QAAQ,AAAAC,IAC3B,GAAIP,CAAS,CAACO,EAAQ,CAACC,UAAW,CAC9B,IAAMC,EAAQ,KAAAC,SAAA,IACRC,EAAW,KAAAC,cAAA,EAAeL,GAEhCM,OAAOC,SAASN,UAAUC,EAAOE,EAAU,CAAC,EACxC,AAAAI,IACuB,aAAfA,EAAMC,OACNf,EAAQ,GAAGgB,QAAQC,IAAI,OAASP,EAAW,aAAcI,EAAMI,QACnE,UAAQC,WAAW,CAAEb,QAAAA,CAAQ,GACjC,GAEJJ,EAAoBkB,KAAKV,EAC7B,CACJ,GACIV,EAAQ,GAAGgB,QAAQC,IAAI,kBAAmBf,EAClD,CACJ,C"}